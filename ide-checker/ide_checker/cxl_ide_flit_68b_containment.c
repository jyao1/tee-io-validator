/**
 *  Copyright Notice:
 *  Copyright 2024 DMTF. All rights reserved.
 *  License: BSD 3-Clause License. For full text see link: https://github.com/DMTF/cxl_flit_68b_containment/blob/main/LICENSE.md
 **/

#include "ide_checker.h"

// CXL Compliance WG

// Cache-Mem Flit Encryption Reference

uint8_t m_cxl_flit_68b_containment[] = {
    // flit 0
    0x24, 0x0c, 0x01, 0x00, // flit header:
                            // 0x24: Type[0]=0(protocol),AK[2]=1b(ack),BE[3]=0,SZ[4]=0,slot0[7:5]=001b(H1)
                            // 0x0c: slot1[2:0]=100b(G4),slot2[5:3]=001b(G1),slot3[7:6]=00b
                            // 0x01: slot3[0]=1b(G4),RspCrd[7:4]=0(cache,no_credit)
                            // 0x00: ReqCrd[3:0]=0(cache,no_credit),DataCrd[7:4]=0(cache,no_credit)
    0x45, 0x00, 0x04, 0xaa,  // Header
    0x14, 0xd3, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    // flit 1
    0x20, 0x0c, 0x01, 0x00, // flit header:
                            // 0x20: Type[0]=0,AK[2]=0b,BE[3]=0,SZ[4]=0,slot0[7:5]=001b(H1)
                            // 0x0c: slot1[2:0]=100b(G4),slot2[5:3]=001b(G1),slot3[7:6]=00b
                            // 0x01: slot3[0]=1b(G4),RspCrd[7:4]=0
                            // 0x00: ReqCrd[3:0]=0,DataCrd[7:4]=0
    0x99, 0x00, 0xe8, 0x8d,  // Header
    0x61, 0xc7, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,  // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    // flit 2
    0x20, 0x61, 0x00, 0x00, // flit header:
                            // 0x20: Type[0]=0,AK[2]=0b,BE[3]=0,SZ[4]=0,slot0[7:5]=001b(H1)
                            // 0x61: slot1[2:0]=001b(G1),slot2[5:3]=100b(G4),slot3[7:6]=01b
                            // 0x00: slot3[0]=0b(G2),RspCrd[7:4]=0
                            // 0x00: ReqCrd[3:0]=0,DataCrd[7:4]=0
    0xcb, 0x00, 0x38, 0x52,  // Header
    0x5e, 0xc4, 0x06, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x1d, 0x01, 0x34, 0x19,  // Generic
    0xb2, 0xf5, 0x02, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    // flit 3
    0x20, 0x15, 0x01, 0x00, // flit header:
                            // 0x20: Type[0]=0,AK[2]=0b,BE[3]=0,SZ[4]=0,slot0[7:5]=001b(H1)
                            // 0x15: slot1[2:0]=101b(G5),slot2[5:3]=010b(G2),slot3[7:6]=00b
                            // 0x01: slot3[0]=1b(G4),RspCrd[7:4]=0
                            // 0x00: ReqCrd[3:0]=0,DataCrd[7:4]=0
    0x51, 0x01, 0x4c, 0x91,  // Header
    0x30, 0xda, 0x06, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    // flit 4
    0x20, 0x55, 0x01, 0x00, // flit header:
                            // 0x20: Type[0]=0,AK[2]=0b,BE[3]=0,SZ[4]=0,slot0[7:5]=001b(H1)
                            // 0x55: slot1[2:0]=101b(G5),slot2[5:3]=010b(G2),slot3[7:6]=01b
                            // 0x01: slot3[0]=1b(G5),RspCrd[7:4]=0
                            // 0x00: ReqCrd[3:0]=0,DataCrd[7:4]=0
    0x93, 0x01, 0x94, 0x82,  // Header
    0x1c, 0xb3, 0x03, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, // Generic
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
};

uint8_t m_cxl_flit_68b_containment_ide_flit[] = {
    // flit 0
    0x24, 0x0c, 0x01, 0x00, // flit header
    0x41, 0xef, 0xa6, 0x23, // flit 0 enc
    0x97, 0xce, 0xef, 0x31,
    0x18, 0x07, 0xc9, 0x1c,
    0xed, 0x4c, 0x61, 0x7a,
    0xed, 0x54, 0x2f, 0x40,
    0xe2, 0x2f, 0x6c, 0x83,
    0xfa, 0xa1, 0x3f, 0x4f,
    0xcf, 0x4f, 0x5a, 0x9d,
    0x9e, 0xfb, 0xea, 0x10,
    0x36, 0xe8, 0x69, 0x52,
    0xc4, 0x1c, 0x46, 0x9f,
    0x66, 0xee, 0x9c, 0x8a,
    0xc4, 0x7f, 0xb4, 0x49,
    0x75, 0x60, 0xe2, 0xea,
    0x76, 0x5d, 0xf3, 0x8a,
    // flit 1
    0x20, 0x0c, 0x01, 0x00, // flit header
    0x5d, 0xf6, 0x1e, 0xa4, // flit 1 enc
    0x4c, 0xa6, 0x40, 0x76,
    0x2e, 0xb2, 0x66, 0x95,
    0x1f, 0x81, 0xf0, 0x39,
    0xf5, 0x04, 0xf8, 0xce,
    0x2f, 0x85, 0xbc, 0xec,
    0x60, 0xd6, 0x87, 0x2a,
    0x65, 0xf8, 0x38, 0xbd,
    0x20, 0xac, 0xf9, 0xf5,
    0xf3, 0xbd, 0xdb, 0x38,
    0xf4, 0x86, 0xdb, 0x88,
    0x4f, 0x17, 0x14, 0x27,
    0xd6, 0xaa, 0x43, 0x98,
    0xc8, 0xa8, 0xc8, 0xdb,
    0x3e, 0x24, 0x80, 0xfd,
    // flit 2
    0x20, 0x61, 0x00, 0x00, // flit header
    0x06, 0x97, 0x10, 0x76, // flit 2 enc
    0x04, 0x10, 0x94, 0x64,
    0x17, 0x54, 0x34, 0x7f,
    0xdb, 0xfb, 0x35, 0x06,
    0xae, 0x69, 0xbe, 0xe6,
    0x51, 0xa8, 0xf4, 0x11,
    0x27, 0x10, 0x4b, 0x13,
    0x96, 0x74, 0x02, 0xc3,
    0x44, 0x22, 0xea, 0x3a,
    0xe6, 0x12, 0x89, 0xc2,
    0x53, 0x34, 0xae, 0x36,
    0x6c, 0x0e, 0xb7, 0xb8,
    0x3b, 0xd2, 0x3d, 0xeb,
    0xf7, 0xbf, 0x90, 0x0d,
    0xad, 0x40, 0x12, 0xea,
    // flit 3
    0x20, 0x15, 0x01, 0x00, // flit header
    0xcc, 0x13, 0x8c, 0x58, // flit 3 enc
    0xb4, 0xbb, 0x36, 0x12,
    0xf6, 0x0d, 0x62, 0x6f,
    0x02, 0x27, 0x87, 0xfd,
    0xa6, 0xaa, 0x6e, 0x14,
    0xb0, 0x77, 0x09, 0xc9,
    0x89, 0xdb, 0xf2, 0xb7,
    0x37, 0x6e, 0x17, 0x76,
    0xed, 0x2c, 0x6f, 0x87,
    0x9c, 0xc7, 0x2b, 0x99,
    0x30, 0xc7, 0x5a, 0x2b,
    0x50, 0x3e, 0xd1, 0x90,
    0xd3, 0x1e, 0x09, 0x46,
    0x31, 0xab, 0x2f, 0xe3,
    0x95, 0x65, 0x44, 0x3b,
    // flit 4
    0x20, 0x55, 0x01, 0x00, // flit header
    0x47, 0x36, 0x21, 0x88, // flit 4 enc
    0x7c, 0x8d, 0xba, 0x76,
    0x43, 0x0e, 0x80, 0x17,
    0x08, 0xe1, 0x51, 0x02,
    0x20, 0x42, 0xd1, 0x23,
    0x17, 0xb2, 0x54, 0xfe,
    0x35, 0xe8, 0x86, 0xd7,
    0x84, 0xb6, 0xfc, 0x20,
    0xec, 0x67, 0xa5, 0x85,
    0x15, 0xe4, 0x68, 0x13,
    0x45, 0x2f, 0xcb, 0xdc,
    0x4e, 0xc7, 0xba, 0x08,
    0xba, 0xff, 0xd5, 0xd2,
    0xcc, 0xbc, 0xf0, 0x13,
    0xfe, 0xe9, 0xfe, 0x08,
};

uint8_t m_cxl_flit_68b_containment_gcm_key[] = {
    0x8A, 0x95, 0x85, 0x8A,
    0x23, 0x1D, 0x41, 0x4A,
    0x37, 0x33, 0xF0, 0xE5,
    0x7A, 0xF6, 0xAE, 0x77,
    0xC7, 0xF0, 0xCF, 0xBA,
    0x75, 0x54, 0xD6, 0x70,
    0x83, 0x34, 0x2A, 0x64,
    0x2A, 0xEF, 0x9D, 0x5D,
};

uint8_t m_cxl_flit_68b_containment_gcm_iv[] = {
    0x80, 0x00, 0x00, 0x00,
    0x70, 0x66, 0x25, 0xe0,
    0x02, 0x81, 0xf7, 0xb8,
};

uint8_t m_cxl_flit_68b_containment_gcm_tag[] = {
    0xe1, 0xdd, 0x06, 0xdf,
    0xa2, 0x22, 0x6a, 0xc0,
    0x5f, 0x33, 0x3e, 0x01,
};

ide_test_packet_data_t m_cxl_flit_68b_containment_gcm_packet_data = {
    "cxl_flit_68b_containment", IDE_TYPE_CXL, 0,
    m_cxl_flit_68b_containment_gcm_key,
    m_cxl_flit_68b_containment_gcm_iv,
    m_cxl_flit_68b_containment, sizeof(m_cxl_flit_68b_containment),
    m_cxl_flit_68b_containment_ide_flit, sizeof(m_cxl_flit_68b_containment_ide_flit),
    m_cxl_flit_68b_containment_gcm_tag,
};
